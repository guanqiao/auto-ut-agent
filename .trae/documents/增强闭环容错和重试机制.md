## 目标
增强 Agent 的容错能力，实现除非人工停止，否则借助 AI 解决所有错误。

## 具体改进点

### 1. 双层错误分析机制
- **第一层**: 本地工具分析 (error_analyzer/failure_analyzer)
- **第二层**: LLM 深度分析 - 将本地分析结果 + 原始错误交给 LLM，让 LLM 给出更智能的修复建议
- 合并两层结果生成更精准的修复 Prompt

### 2. 无限重试机制 (除非人工停止)
- 移除修复失败直接返回的逻辑
- 引入 "修复尝试计数器"
- 每次修复失败后，将失败原因反馈给 LLM，让 LLM 调整修复策略
- 实现指数退避重试策略
- 只有用户点击"停止"时才退出

### 3. 工具调用错误统一处理
- 所有工具调用包装在 try-catch 中
- 工具调用异常也交给 LLM 分析原因
- LLM 可以建议：重试、跳过、换用其他工具、修改参数等

### 4. 智能修复策略调整
- 记录每次修复尝试的历史
- 如果多次修复同一错误失败，LLM 会收到历史记录，调整策略
- 支持"破坏性修复"选项（如删除有问题的测试方法重新生成）

### 5. 新增模块
- `error_recovery.py` - 错误恢复管理器，统一处理所有错误类型
- `retry_manager.py` - 重试策略管理器
- 扩展 `prompts.py` - 添加更多修复相关的 Prompt 模板

### 6. 关键修改
- 修改 `react_agent.py` 的主循环逻辑
- 所有步骤错误都进入统一的错误恢复流程
- 添加 `should_stop()` 检查，仅响应用户停止信号

## 实施步骤
1. 创建 `error_recovery.py` - 统一错误恢复入口
2. 创建 `retry_manager.py` - 重试策略管理
3. 扩展 `prompts.py` - 添加 LLM 错误分析 Prompt
4. 重构 `react_agent.py` - 实现无限重试循环
5. 更新 `base_agent.py` - 添加停止信号机制